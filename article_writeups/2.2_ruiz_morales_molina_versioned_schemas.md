# Reflection on [Inferring Versioned Schemas from NoSQL Databases and Its Applications](https://link-springer-com.proxybz.lib.montana.edu/chapter/10.1007%2F978-3-319-25264-3_35)

#### Sevilla Ruiz D., Morales S.F., García Molina J. (2015) Inferring Versioned Schemas from NoSQL Databases and Its Applications. In: Johannesson P., Lee M., Liddle S., Opdahl A., Pastor López Ó. (eds) Conceptual Modeling. ER 2015. Lecture Notes in Computer Science, vol 9381. Springer, Cham. https://doi-org.proxybz.lib.montana.edu/10.1007/978-3-319-25264-3_35

[(home)](https://beqpolk1.github.io/csci-592-spring2022/)

---

This article by Ruiz, Morales, and Morales presented a very interesting technique for extracting an implicit schema from a NoSQL database. In the course of that work, they also make a compelling case for the utility of schemas even for NoSQL databases, define an interesting structure for NoSQL data for two common paradigms, and give examples of the types of useful tools that can be created using NoSQL schemas.

One of the first moves by the authors is to describe their conception of the data-model common to most NoSQL databases. They focus on **aggregates** and **aggregate-orientation** as a characteristic shared between three prominent NoSQL systems (CouchDB, MongoDB, and HBase). Since NoSQL systems are often distributed over many nodes and not engineered to support join operations, standard practice is to embed objects within other objects to avoid fetching data from more than one location. Hence, objects aggregate other objects into their definition, yielding a tree structure. This aligns with the ideas in [the paper I read last week]( 2.1_atzeni_et_al_data_model_nosql.md) on NoSQL Data Modeling by Atzeni et al., but contrasts with previous readings that took more of an object oriented or graph approach to data metamodels. It would be interesting to attempt to reconcile these viewpoints. However, the metamodel in this paper does still allow for one object to *reference* another, as opposed to aggregating it.

Otherwise, I appreciated that Ruiz et al. also provided an actual definition of the “flexibility” that makes a NoSQL database advantageous for some applications – it lies in the ability for the same entities to have different structures. Even with this flexibility, they also point out that, “…removing the need of declaring explicit schemas does not have to be confused with the absence of a schema,” and provide examples of why having a formal schema defined can be useful. Cases include data validation, catching mistakes made by developers, and aiding in query optimization. The authors draw a useful analogy between schemaless database development and dynamic typing in programming languages.

The general process for inferring schemas from a NoSQL database follows a “reverse engineering” approach, which is made up of several steps. First, a collection of JSON objects is generated, one for each version of each entity. These collections are generated by a Map-Reduce operation. Next, these collections are “injected” into a metamodel that conforms to a JSON standard as described by the authors. Finally, that JSON metamodel is transformed into a separate model conforming to the authors’ NoSQL metamodel (presented in UML), which can be used with MDE (model driven engineering) processes for developing database tools. Below is my interpretation of the process as described by Ruiz et al., and the authors’ own UML diagram for the NoSQL metamodel.

![My Understanding of the Schema Inference Process](/images/2.2_inference_process.jpg)
My Understanding of the Schema Inference Process

![Ruiz et al.'s Metamodel for NoSQL Databases](/images/2.2_nosql_metamodel.gif)
Ruiz et al.'s Metamodel for NoSQL Databases

I was somewhat surprised by the straightforward nature of the authors’ approach to extracting schemas from a database. I was expecting the employment of some machine learning techniques or heuristics, but these were unnecessary. The utilization of a Map-Reduce technique to ensure only one candidate object per entity version is a noteworthy aspect of the process. Still, this is only possible due to what, in my opinion, is a definite shortcoming of Ruiz et al.’s approach: in a certain manner, they still require the data to adhere to a certain, more general schema in order for the specific schema to be extracted. Entities must be associated with a certain type, and the matching to determine aggregate or reference relationships is sensitive to entities having the exact same type names. In some ways, this is understandable and a fair requirement to impose in order to generate a high-quality schema. Yet, I can’t help but wonder if there would be a way to employ data mining or machine learning techniques to detect entities or aggregates with similar definitions and group them as such; this could be an interesting feature of a potential project.

Otherwise, Ruiz et al. discuss a couple of applications of the inferred schemas once the extraction process is complete and an instance of the NoSQL schema metamodel is obtained. They use MDE techniques to automatically generate tools that rely on the schema metamodel. For one example application, schema visualization, they present both a UML diagram and a textual description of the schema inferred from a database. For the other example, validation of data against a schema, they illustrate how different versions of an entity may be related and present automatically generated code that checks whether an object is an instance of a certain entity and version. It was pretty neat to see how these sorts of tools could be automatically generated once an appropriate metamodel is defined and an instance of it created, and this gives even more weight to the idea that schemas are still valuable for NoSQL databases.

I appreciated that this paper included a fairly comprehensive “Related Work” section. One interesting bit was a reference to an older paper by Bugiotti, Cabibbo, Atzeni, and Torlone (the authors of last week’s reading) that discussed their NoAM data model. However, as the authors here point out, one of the main advantages of their schema inference approach is that it allows for *versions* of entities to exist in the database. This captures the essence of the flexibility that makes many NoSQL systems so enticing, and I agree that it is a major improvement to the data model. I would think that any robust, comprehensive modeling technique for NoSQL databases would have to capture this “versioning” aspect. Despite some shortcomings, overall this was a very worthwhile read and uniquely explored some NoSQL concepts. I think Ruiz et al. have presented the most compelling NoSQL data model that I have seen so far, and I will be very intrigued to see how well it reconciles with some other approaches as I start to get into the articles that propose universal solutions for managing heterogeneous data.
